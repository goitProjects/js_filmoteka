"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var genres,moviesList=document.querySelector("#js-moviesList"),renderFilms=[];function createCardFunc(e,t,n){var a=document.createElement("li");a.classList.add("main__filmListItem"),a.setAttribute("id","js-filmListItem");var i=document.createElement("img");i.classList.add("main__filmListItemImg"),i.setAttribute("src","https://image.tmdb.org/t/p/w500/".concat(e));var r=document.createElement("h2");return r.classList.add("main__filmListItemTitle"),r.textContent=t,a.append(i,r),a.addEventListener("click",function(){return activeDetailsPage(n,!1)}),a}var fetchPopularMoviesList=function(){fetch("https://api.themoviedb.org/3/movie/popular?api_key=4aa539255aa0c2506cf45806a15a8a0a&language=en-US&page=".concat(pageNumber)).then(function(e){return e.json()}).then(function(e){return 1<e.results.length&&(moviesList.innerHTML=""),e.results.forEach(function(e){moviesList.insertAdjacentElement("beforeend",createCardFunc(e.backdrop_path,e.title,e.id))}),renderFilms=e.results}).catch(function(e){return console.log(e)})};function fetchGenres(){fetch("https://api.themoviedb.org/3/genre/movie/list?api_key=4aa539255aa0c2506cf45806a15a8a0a&language=en-US").then(function(e){return e.json()}).then(function(e){genres=_toConsumableArray(e.genres)}).catch(function(e){return console.log(e)})}fetchPopularMoviesList(),fetchGenres();var searchFilmForm=document.querySelector("#js-form"),searchFilmInput=document.querySelector("#js-input"),backButton=document.querySelector("#js-backButton");backButton.classList.add("main__hide");var nextButton=document.querySelector("#js-nextButton"),plaginationPageNumber=document.querySelector("#js-plaginationPageNumber"),pError=document.querySelector("#js-error"),inputValue="",pageNumber=1;function fetchFilms(){fetch("https://api.themoviedb.org/3/search/movie?api_key=4aa539255aa0c2506cf45806a15a8a0a&language=en-US&page=".concat(pageNumber,"&include_adult=false&query=").concat(inputValue)).then(function(e){return e.json()}).then(function(e){return 0===e.results.length&&(pError.textContent="Search result not successful. Enter the correct movie name and try again."),1<e.results.length&&(moviesList.innerHTML="",pError.textContent=""),e.results.forEach(function(e){moviesList.insertAdjacentElement("beforeend",createCardFunc(e.backdrop_path,e.title,e.id))}),renderFilms=e.results}).catch(function(e){return console.log(e)})}function serchFilm(e){e.preventDefault(),inputValue=searchFilmInput.value,searchFilmForm.reset(),fetchFilms()}function plaginationNavigation(e){1===pageNumber||pageNumber<1?backButton.classList.add("main__hide"):backButton.classList.remove("main__hide"),"js-backButton"===e.target.id?pageNumber-=1:pageNumber+=1,plaginationPageNumber.textContent=pageNumber,""===inputValue?fetchPopularMoviesList():fetchFilms(),1===pageNumber||pageNumber<1?backButton.classList.add("main__hide"):backButton.classList.remove("main__hide")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}searchFilmForm.addEventListener("submit",serchFilm),backButton.addEventListener("click",plaginationNavigation),nextButton.addEventListener("click",plaginationNavigation);var linkHomePage=document.querySelector("#js-linkHomePage"),linkLibraryPage=document.querySelector("#js-linkLibraryPage"),sectionHomePage=document.querySelector("#js-homePage"),sectionLibraryPage=document.querySelector("#js-libraryPage"),sectionDetailsPage=document.querySelector("#js-detailsPage"),queueListButton=document.querySelector("#js-navigationLibraryButtonQueue"),watchedListButton=document.querySelector("#js-navigationLibraryButtonWatched"),addQueueButton=document.querySelector("#js-addQueueButton"),addWatchedButton=document.querySelector("#js-addWatchedButton"),logoH1=document.querySelector("#js-logo"),selectFilm={};function activeHomePage(){sectionLibraryPage.classList.add("main__hide"),sectionDetailsPage.classList.add("main__hide"),sectionHomePage.classList.remove("main__hide"),backButton.addEventListener("click",plaginationNavigation),nextButton.addEventListener("click",plaginationNavigation),addQueueButton.removeEventListener("click",toggleToQueue),addWatchedButton.removeEventListener("click",toggleToWatched),queueListButton.removeEventListener("click",drawQueueFilmList),watchedListButton.removeEventListener("click",drawWatchedFilmList)}function activeLibraryPage(){sectionHomePage.classList.add("main__hide"),sectionDetailsPage.classList.add("main__hide"),sectionLibraryPage.classList.remove("main__hide"),drawQueueFilmList(),queueListButton.classList.add("main__navigationLibraryButtonActive"),queueListButton.addEventListener("click",drawQueueFilmList),watchedListButton.addEventListener("click",drawWatchedFilmList),addQueueButton.removeEventListener("click",toggleToQueue),addWatchedButton.removeEventListener("click",toggleToWatched),backButton.removeEventListener("click",plaginationNavigation),nextButton.removeEventListener("click",plaginationNavigation)}function activeDetailsPage(t,e){if(sectionHomePage.classList.add("main__hide"),sectionLibraryPage.classList.add("main__hide"),sectionDetailsPage.classList.remove("main__hide"),e){var n=[].concat(_toConsumableArray(JSON.parse(localStorage.getItem("filmsQueue"))),_toConsumableArray(JSON.parse(localStorage.getItem("filmsWatched"))));selectFilm=n.find(function(e){return e.id===t})}else selectFilm=renderFilms.find(function(e){return e.id===t});showDetails(selectFilm),addQueueButton.addEventListener("click",toggleToQueue),addWatchedButton.addEventListener("click",toggleToWatched),queueListButton.removeEventListener("click",drawQueueFilmList),watchedListButton.removeEventListener("click",drawWatchedFilmList),backButton.removeEventListener("click",plaginationNavigation),nextButton.removeEventListener("click",plaginationNavigation)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function toggleToQueue(){var e,t=[],n=localStorage.getItem("filmsQueue");null!==n&&(e=t).push.apply(e,_toConsumableArray(JSON.parse(n)));t.find(function(e){return e.id===selectFilm.id})?t=t.filter(function(e){return e.id!==selectFilm.id}):t.push(selectFilm),localStorage.setItem("filmsQueue",JSON.stringify(t)),monitorButtonStatusText()}function toggleToWatched(){var e,t=[],n=localStorage.getItem("filmsWatched");null!==n&&(e=t).push.apply(e,_toConsumableArray(JSON.parse(n)));t.find(function(e){return e.id===selectFilm.id})?t=t.filter(function(e){return e.id!==selectFilm.id}):t.push(selectFilm),localStorage.setItem("filmsWatched",JSON.stringify(t)),monitorButtonStatusText()}function showDetails(e){document.querySelector("#js-detailsImg").setAttribute("src","https://image.tmdb.org/t/p/w500/".concat(e.poster_path)),document.querySelector("#js-detailsTitle").textContent=e.title,document.querySelector("#js-vote").textContent=e.vote_average,document.querySelector("#js-popularity").textContent=e.popularity,document.querySelector("#js-originalTitle").textContent=e.original_title,document.querySelector("#js-genre").textContent=String(genres.filter(function(t){return!!e.genre_ids.find(function(e){return t.id===e})}).reduce(function(e,t){return e+"".concat(t.name,", ")},"")).slice(0,-2),document.querySelector("#js-detailsAboutText").textContent=e.overview,monitorButtonStatusText()}function monitorButtonStatusText(){var e=localStorage.getItem("filmsQueue");null===e?addQueueButton.textContent="Add to queue":JSON.parse(e).find(function(e){return e.id===selectFilm.id})?addQueueButton.textContent="Delete from queue":addQueueButton.textContent="Add to queue";var t=localStorage.getItem("filmsWatched");null===t?addWatchedButton.textContent="Add to watched":JSON.parse(t).find(function(e){return e.id===selectFilm.id})?addWatchedButton.textContent="Delete from watched":addWatchedButton.textContent="Add to watched"}sectionLibraryPage.classList.add("main__hide"),sectionDetailsPage.classList.add("main__hide"),linkHomePage.addEventListener("click",activeHomePage),linkLibraryPage.addEventListener("click",activeLibraryPage),logoH1.addEventListener("click",activeHomePage);var libraryFilmList=document.querySelector("#js-libraryFilmList");function createLibraryCardFunc(e,t,n,a){var i=document.createElement("li");i.classList.add("main__filmListItem"),i.setAttribute("id","js-filmListItem");var r=document.createElement("img");r.classList.add("main__filmListItemImg"),r.setAttribute("src","https://image.tmdb.org/t/p/w500/".concat(e));var o=document.createElement("h2");o.classList.add("main__filmListItemTitle"),o.textContent=t;var c=document.createElement("h3");return c.classList.add("main__filmVote"),c.textContent=a,i.append(r,o,c),i.addEventListener("click",function(){return activeDetailsPage(n,!0)}),i}function drawQueueFilmList(){var t=document.createDocumentFragment(),e=localStorage.getItem("filmsQueue");if(null!==e&&0!==JSON.parse(e).length)JSON.parse(e).forEach(function(e){t.append(createLibraryCardFunc(e.backdrop_path,e.title,e.id,e.vote_average))}),libraryFilmList.innerHTML="",libraryFilmList.append(t);else if(null===e||0===JSON.parse(e).length){libraryFilmList.innerHTML="";var n=document.createElement("li");n.classList.add("main__noFilmsInList"),n.textContent="You do not have to queue movies to watch. Add them.",libraryFilmList.append(n)}queueListButton.classList.add("main__navigationLibraryButtonActive"),watchedListButton.classList.remove("main__navigationLibraryButtonActive")}function drawWatchedFilmList(){var t=document.createDocumentFragment(),e=localStorage.getItem("filmsWatched");if(null!==e&&0!==JSON.parse(e).length)JSON.parse(e).forEach(function(e){t.append(createLibraryCardFunc(e.backdrop_path,e.title,e.id,e.vote_average))}),libraryFilmList.innerHTML="",libraryFilmList.append(t);else if(null===e||0===JSON.parse(e).length){libraryFilmList.innerHTML="";var n=document.createElement("li");n.classList.add("main__noFilmsInList"),n.textContent="You do not have watched movies. Add them.",libraryFilmList.append(n)}queueListButton.classList.remove("main__navigationLibraryButtonActive"),watchedListButton.classList.add("main__navigationLibraryButtonActive")}